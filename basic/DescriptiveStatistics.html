<html>
    <head>
      <!--<meta name="google-site-verification" content="Z7SEnQaO9LAITbhuwGaI3rFtnpMRKeV9BbaW3LyvP2g" />-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="revised" content="2 May 2022" />
        <title>Descriptive statistics</title>

        <link rel="stylesheet" href="https://latex.now.sh/style.css"> 
        <link rel="stylesheet" href="https://alanintsukuba.github.io/ShowReferencesModal.css"> 
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" 
integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" 
integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]-->    
</head>
<body>
<h1>Descriptive statistics</h1>
<p class="author"><a href="https://orcid.org/0000-0003-0070-2347" target="_blank">Alan Engel</a><br>Last update: 
    2 May 2022</p>
<main>
    <p>This task produces a table of descriptive statistics similar to Table 3 in <a href="#Elbers2021">Elbers (2021)</a>. 
    Except where noted, the statistics are generated using the R scripts included below.</p>
    <table class="table" style="margin-left: auto; margin-right: auto;">
        <thead>
         <tr>
          <th style="text-align:left;text-align: center;">  </th>
          <th style="text-align:right;text-align: center;"> 1985 </th>
          <th style="text-align:right;text-align: center;"> 1990 </th>
          <th style="text-align:right;text-align: center;"> 1995 </th>
          <th style="text-align:right;text-align: center;"> 2000 </th>
          <th style="text-align:right;text-align: center;"> 2005 </th>
         </tr>
        </thead>
       <tbody>
         <tr>
          <td style="text-align:left;"> Sample size (in 1000) </td>
          <td style="text-align:right;"> 60193 </td>
          <td style="text-align:right;"> 67032 </td>
          <td style="text-align:right;"> 70265 </td>
          <td style="text-align:right;"> 70352 </td>
          <td style="text-align:right;"> 65713 </td>
         </tr>
         <tr grouplength="3"><td colspan="6" style="border-bottom: 1px solid;"><strong>A. Number of occupations</strong></td></tr>
       <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> Number of occupations </td>
          <td style="text-align:right;"> 261 </td>
          <td style="text-align:right;"> 260 </td>
          <td style="text-align:right;"> 261 </td>
          <td style="text-align:right;"> 263 </td>
          <td style="text-align:right;"> 263 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> Appearing occupations </td>
          <td style="text-align:right;">  </td>
          <td style="text-align:right;"> 1 </td>
          <td style="text-align:right;"> 1 </td>
          <td style="text-align:right;"> 2 </td>
          <td style="text-align:right;"> 1 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> Disappearing occupations </td>
          <td style="text-align:right;">  </td>
          <td style="text-align:right;"> 2 </td>
          <td style="text-align:right;"> 0 </td>
          <td style="text-align:right;"> 0 </td>
          <td style="text-align:right;"> 1 </td>
         </tr>
         <tr grouplength="1"><td colspan="6" style="border-bottom: 1px solid;"><strong>B. Labor force participation (%)</strong></td></tr>
       <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> Female </td>
          <td style="text-align:right;"> 37 </td>
          <td style="text-align:right;"> 39 </td>
          <td style="text-align:right;"> 40 </td>
          <td style="text-align:right;"> 41 </td>
          <td style="text-align:right;"> 43 </td>
         </tr>
         <tr grouplength="9"><td colspan="6" style="border-bottom: 1px solid;"><strong>C. Distribution of occupational major groups (%)</strong></td></tr>
       <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> A SPECIALIST / TECHNICAL </td>
          <td style="text-align:right;"> 11 </td>
          <td style="text-align:right;"> 11 </td>
          <td style="text-align:right;"> 12 </td>
          <td style="text-align:right;"> 12 </td>
          <td style="text-align:right;"> 14 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> B MANAGERIAL </td>
          <td style="text-align:right;"> 4 </td>
          <td style="text-align:right;"> 4 </td>
          <td style="text-align:right;"> 4 </td>
          <td style="text-align:right;"> 3 </td>
          <td style="text-align:right;"> 2 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> C CLERICAL </td>
          <td style="text-align:right;"> 13 </td>
          <td style="text-align:right;"> 18 </td>
          <td style="text-align:right;"> 18 </td>
          <td style="text-align:right;"> 17 </td>
          <td style="text-align:right;"> 19 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> D SALES </td>
          <td style="text-align:right;"> 15 </td>
          <td style="text-align:right;"> 14 </td>
          <td style="text-align:right;"> 15 </td>
          <td style="text-align:right;"> 15 </td>
          <td style="text-align:right;"> 13 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> E SERVICES </td>
          <td style="text-align:right;"> 7 </td>
          <td style="text-align:right;"> 7 </td>
          <td style="text-align:right;"> 8 </td>
          <td style="text-align:right;"> 10 </td>
          <td style="text-align:right;"> 13 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> F SECURITY </td>
          <td style="text-align:right;"> 1 </td>
          <td style="text-align:right;"> 2 </td>
          <td style="text-align:right;"> 2 </td>
          <td style="text-align:right;"> 2 </td>
          <td style="text-align:right;"> 2 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> G AG, F &amp; F </td>
          <td style="text-align:right;"> 9 </td>
          <td style="text-align:right;"> 7 </td>
          <td style="text-align:right;"> 5 </td>
          <td style="text-align:right;"> 5 </td>
          <td style="text-align:right;"> 4 </td
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> H TRANSPORT &amp; COMM </td>
          <td style="text-align:right;"> 4 </td>
          <td style="text-align:right;"> 4 </td>
          <td style="text-align:right;"> 4 </td>
          <td style="text-align:right;"> 3 </td>
          <td style="text-align:right;"> 3 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> I MANUF., PRODUCTION </td>
          <td style="text-align:right;"> 32 </td>
          <td style="text-align:right;"> 31 </td>
          <td style="text-align:right;"> 30 </td>
          <td style="text-align:right;"> 29 </td>
          <td style="text-align:right;"> 28 </td>
         </tr>
         <tr>
            <td style="text-align:left;padding-left: 2em;" indentlevel="1"> I MACHINERY OPERATORS </td>
            <td style="text-align:right;"> 2 </td>
            <td style="text-align:right;"> 1 </td>
            <td style="text-align:right;"> 1 </td>
            <td style="text-align:right;"> 1 </td>
            <td style="text-align:right;"> 1 </td>
           </tr>
           <tr>
            <td style="text-align:left;padding-left: 2em;" indentlevel="1"> I MINE, CONSTRUCTION WORKERS </td>
            <td style="text-align:right;"> 9 </td>
            <td style="text-align:right;"> 9 </td>
            <td style="text-align:right;"> 9 </td>
            <td style="text-align:right;"> 9 </td>
            <td style="text-align:right;"> 9 </td>
           </tr>
             <tr grouplength="9"><td colspan="6" style="border-bottom: 1px solid;"><strong>D. Female labor force by major groups (%)</strong></td></tr>
       <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> A SPECIALIST / TECHNICAL </td>
          <td style="text-align:right;"> 40 </td>
          <td style="text-align:right;"> 41 </td>
          <td style="text-align:right;"> 42 </td>
          <td style="text-align:right;"> 43 </td>
          <td style="text-align:right;"> 44 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> B MANAGERIAL </td>
          <td style="text-align:right;"> 8 </td>
          <td style="text-align:right;"> 9 </td>
          <td style="text-align:right;"> 10 </td>
          <td style="text-align:right;"> 11 </td>
          <td style="text-align:right;"> 12 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> C CLERICAL </td>
          <td style="text-align:right;"> 52 </td>
          <td style="text-align:right;"> 61 </td>
          <td style="text-align:right;"> 62 </td>
          <td style="text-align:right;"> 62 </td>
          <td style="text-align:right;"> 61 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> D SALES </td>
          <td style="text-align:right;"> 35 </td>
          <td style="text-align:right;"> 34 </td>
          <td style="text-align:right;"> 35 </td>
          <td style="text-align:right;"> 33 </td>
          <td style="text-align:right;"> 38 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> E SERVICES </td>
          <td style="text-align:right;"> 63 </td>
          <td style="text-align:right;"> 61 </td>
          <td style="text-align:right;"> 62 </td>
          <td style="text-align:right;"> 65 </td>
          <td style="text-align:right;"> 67 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> F SECURITY </td>
          <td style="text-align:right;"> 3 </td>
          <td style="text-align:right;"> 3 </td>
          <td style="text-align:right;"> 5 </td>
          <td style="text-align:right;"> 5 </td>
          <td style="text-align:right;"> 6 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> G AG, F &amp; F </td>
          <td style="text-align:right;"> 45 </td>
          <td style="text-align:right;"> 44 </td>
          <td style="text-align:right;"> 43 </td>
          <td style="text-align:right;"> 43 </td>
          <td style="text-align:right;"> 41 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> H TRANSPORT &amp; COMM </td>
          <td style="text-align:right;"> 5 </td>
          <td style="text-align:right;"> 5 </td>
          <td style="text-align:right;"> 5 </td>
          <td style="text-align:right;"> 5 </td>
          <td style="text-align:right;"> 4 </td>
         </tr>
         <tr>
          <td style="text-align:left;padding-left: 2em;" indentlevel="1"> I MANUF., PRODUCTION </td>
          <td style="text-align:right;"> 38 </td>
          <td style="text-align:right;"> 39 </td>
          <td style="text-align:right;"> 38 </td>
          <td style="text-align:right;"> 39 </td>
          <td style="text-align:right;"> 37 </td>
         </tr>
         <tr>
            <td style="text-align:left;padding-left: 2em;" indentlevel="1"> I MACHINERY OPERATORS</td>
            <td style="text-align:right;"> 1 </td>
            <td style="text-align:right;"> 1 </td>
            <td style="text-align:right;"> 1 </td>
            <td style="text-align:right;"> 1 </td>
            <td style="text-align:right;"> 1 </td>
           </tr>
           <tr>
            <td style="text-align:left;padding-left: 2em;" indentlevel="1"> I MINE, CONSTRUCTION WORKERS </td>
            <td style="text-align:right;"> 20 </td>
            <td style="text-align:right;"> 22 </td>
            <td style="text-align:right;"> 24 </td>
            <td style="text-align:right;"> 26 </td>
            <td style="text-align:right;"> 27 </td>
           </tr>
           </tbody>
       </table>
<pre><code class="language-html">#' DescriptiveStatistics.R
#' 2021-12-15
#' Revised 2022-5-2

#' Adapted from
#' Elbers, Benjamin. A Method for Studying Differences in Segregation Across Time and Space. 
#' SocArXiv, 21 Dec. 2018, supplementary materials

library("tidyverse")
library("tidylog", warn.conflicts = FALSE)
library("fst")
library("ggthemes")
library("segregation")
library("cowplot")
library("knitr")
library("kableExtra")

## data is in occgenall
head(occgenall)
#' Harmonized occupation classes to get main group titles
# V02 created 2022-4-19
#' hoc is created in BuildMasterDataset.R.

# make copy to use as Elbers
d <- as_tibble(occgenall) %>%
    mutate(w = n,OccSub = as.character(OccSub),
    OccMain = as.character(OccMain), OccSub=as.character(OccSub),
    OccMid=as.character(OccMid),OccMinor=as.character(OccMinor),
    year = as.integer(year)) %>%
    filter(OccMinor != 1267)
head(d)

##########################
###### descriptives ######
##########################

samplesize <- d %>% filter(!is.na(n)) %>%
    group_by(year) %>%
    summarize(n = sum(w)) %>%
    mutate(var = "Sample size (in 1000)",
        n = round(n / 1000)) %>%
    spread(year, n)

occ1985 <- filter(d, year == 1985) %>% pull(OccMinor) %>% unique
occ1990 <- filter(d, year == 1990) %>% pull(OccMinor) %>% unique
occ1995 <- filter(d, year == 1995) %>% pull(OccMinor) %>% unique
occ2000 <- filter(d, year == 2000) %>% pull(OccMinor) %>% unique
occ2005 <- filter(d, year == 2005) %>% pull(OccMinor) %>% unique
common_occ <- intersect(occ1985 , occ1990 ) %>%
    intersect(occ1995 ) %>% intersect(occ2000 ) %>% 
    intersect(occ2005 )

nocc <- tribble(~var, ~`1985`, ~`1990`, ~`1995`, ~`2000`, ~`2005`,
    "Number of occupations", length(occ1985),
        length(occ1990), length(occ1995), length(occ2000),
    length(occ2005),
    "Appearing occupations", NA,
        length(setdiff(occ1990, occ1985)),
        length(setdiff(occ1995, occ1990)),
        length(setdiff(occ2000, occ1995)),
        length(setdiff(occ2005, occ2000)),
    "Disappearing occupations", NA,
        length(setdiff(occ1985, occ1990)),
        length(setdiff(occ1990, occ1995)),
        length(setdiff(occ1995, occ2000)),
        length(setdiff(occ2000, occ2005))
    )

gender <- d %>% filter(!is.na(w)) %>%
    group_by(year, Gender) %>%
    summarize(n = sum(w)) %>%
    group_by(year) %>%
    mutate(p = round(n / sum(n) * 100)) %>%
    filter(Gender == "FEMALE") %>%
    select(-n) %>%
    spread(year, p) %>%
    rename(var = Gender)

occ <- d %>% filter(!is.na(w)) %>%
    group_by(year, OccMain,OccSub) %>%
    summarize(n = sum(w)) %>%
    group_by(year) %>%
    mutate(p = round(n / sum(n) * 100)) %>%
    select(-n) %>%
    spread(year, p) %>%
    merge(hoc[nchar(hoc$MainTitle)>0,c("OccMain","OccSub","MainTitle")]) %>%
    mutate(OccMain = paste(OccMain,MainTitle,sep=" "))  %>%
    select(-MainTitle,-OccSub) %>%
    rename(var = OccMain)

occ_gender <- d %>% filter(!is.na(w)) %>%
    group_by(year, OccMain,OccSub, Gender) %>%
    summarize(n = sum(w)) %>%
    group_by(year, OccMain,OccSub) %>%
    mutate(p = round(n / sum(n) * 100)) %>%
    filter(Gender== "FEMALE") %>%
    select(-n, -Gender) %>%
    spread(year, p) %>%
    merge(hoc[nchar(hoc$MainTitle)>0,c("OccMain","OccSub","MainTitle")]) %>%
    mutate(OccMain = paste(OccMain,MainTitle,sep=" "))  %>%
    select(-MainTitle,-OccSub) %>%
    rename(var = OccMain)

desc <- bind_rows(samplesize, nocc, gender, occ, occ_gender)
desc[5, "var"] <- "Female"
names(desc)[[1]] <- ""

options(knitr.kable.NA = "")
kable(desc, "latex", booktabs = T) %>%
    kable_styling(latex_options = c("striped", "condensed"),
        position = "center") %>%
    row_spec(0, align = "c") %>%
    group_rows("A. Number of occupations", 2, 4) %>%
    group_rows("B. Labor force participation (%)", 5, 5) %>%
    group_rows("C. Distribution of occupational major groups (%)", 6, 16) %>%
    group_rows("D. Female labor force by major groups (%)", 17, 27) %>%
    cat(file = "Output/desc.tex", sep = "\n")

kable(desc, "html", booktabs = T) %>%
    kable_styling(latex_options = c("striped", "condensed"),
        position = "center") %>%
    row_spec(0, align = "c") %>%
    group_rows("A. Number of occupations", 2, 4) %>%
    group_rows("B. Labor force participation (%)", 5, 5) %>%
    group_rows("C. Distribution of occupational major groups (%)", 6, 16) %>%
    group_rows("D. Female labor force by major groups (%)", 17, 27) %>%
    cat(file = "Output/desc.html", sep = "\n")
</code></pre>
</main>
<div id="references" class="section level2">
    <h2 class="hasAnchor">
    <a href="#references" class="anchor"></a>References</h2>
    <p><a id="Elbers2021">Elbers, Benjamin (2021)</a>. A Method for Studying Differences in Segregation Across Time and Space. 
    Sociological Methods &amp; Research. <a href="https://doi.org/10.1177/0049124121986204" 
    class="uri" target="blank">https://doi.org/10.1177/0049124121986204</a></p>
    </div>
</body>
</html>