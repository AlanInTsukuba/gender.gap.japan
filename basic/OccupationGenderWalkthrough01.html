<!DOCTYPE html>
<html>
    <head>
      <!--<meta name="google-site-verification" content="Z7SEnQaO9LAITbhuwGaI3rFtnpMRKeV9BbaW3LyvP2g" />-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="revised" content="15 November 2021" />
        <title>Basic walkthrough of Elbers's segregation package using Japanese population census data</title>

        <link rel="stylesheet" href="https://latex.now.sh/style.css"> 
        <link rel="stylesheet" href="https://alanintsukuba.github.io/ShowReferencesModal.css"> 
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" 
integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" 
integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]-->    
</head>
<body>
<h1>Basic walkthrough of Elbers's segregation package using Japanese population census data</h1>
<p class="author"><a href="https://orcid.org/0000-0003-0070-2347" target="_blank">Alan Engel</a><br>Last update: 
16 November 2021</p>
<main>
<article>
<p>This walkthough follows <a href="https://elbersb.github.io/segregation/articles/segregation.html" 
target="_blank">Elbers's</a> closely, to the extent that sections of his text are copied verbatim. This is so 
readers can concentrate on the mathematics and data without getting hung up on linguistics.</p>
<blockquote>The segregation package includes functionality to calculate entropy-based segregation measures, 
namely the Mutual Information Index (M) and the Theil Index (H), which is a normalized version of the M index. 
The package also includes several methods for decomposing the index into between/within components and into 
local segregation scores, as well as methods to decompose differences in segregation indices. 
All of these methods have arguments to obtain standard errors and confidence intervals through bootstrapping.
<cite><a href="https://elbersb.github.io/segregation/articles/segregation.html" 
target="_blank">Elbers</a></cite>
</blockquote>
</article>
<article>
<blockquote>
<div id="the-basic-mathematics" class="section level2">
<h2 class="hasAnchor">
<a href="#the-basic-mathematics" class="anchor"></a>The basic mathematics</h2>
<p>The idea of a segregation index is to summarize a contingency table to a single number. For instance, we may have a table with <span class="math inline">\(U\)</span> units, say schools or occupations, and <span class="math inline">\(G\)</span> groups, say gender or racial groups. For each combination of unit and group we have a count, <span class="math inline">\(t_{ug}\)</span>. Arranged in a <span class="math inline">\(U\times G\)</span> matrix <span class="math inline">\(\mathbf{T}\)</span>, this is what the structure of the data looks like:</p>
<table class="table">
<thead><tr class="header">
<th align="center"></th>
<th align="center"><span class="math inline">\(g=1\)</span></th>
<th align="center">…</th>
<th align="center"><span class="math inline">\(g=G\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(u=1\)</span></td>
<td align="center"><span class="math inline">\(t_{11}\)</span></td>
<td align="center">…</td>
<td align="center"><span class="math inline">\(t_{1G}\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(u=2\)</span></td>
<td align="center"><span class="math inline">\(t_{21}\)</span></td>
<td align="center">…</td>
<td align="center"><span class="math inline">\(t_{2G}\)</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(u=3\)</span></td>
<td align="center"><span class="math inline">\(t_{31}\)</span></td>
<td align="center">…</td>
<td align="center"><span class="math inline">\(t_{3G}\)</span></td>
</tr>
<tr class="even">
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
<td align="center">…</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(u=U\)</span></td>
<td align="center"><span class="math inline">\(t_{U1}\)</span></td>
<td align="center">…</td>
<td align="center"><span class="math inline">\(t_{UG}\)</span></td>
</tr>
</tbody>
</table>
<p>From this matrix, we can define <span class="math inline">\(t=\sum_{u=1}^U\sum_{g=1}^G t_{ug}\)</span>, the total population size. The joint probability of being in unit <span class="math inline">\(u\)</span> and racial group <span class="math inline">\(g\)</span> is <span class="math inline">\(p_{ug}=t_{ug}/t\)</span>. Also define <span class="math inline">\(p_{u \cdot}=\sum_{g=1}^{G}t_{ug}/t\)</span> and <span class="math inline">\(p_{\cdot g}=\sum_{u=1}^{U}t_{ug}/t\)</span> as the marginal probabilities of units and groups, respectively. The <strong>Mutual Information Index</strong> is then defined as</p>
<p><span class="math display">\[
M(\mathbf{T})=\sum_{u=1}^U\sum_{g=1}^Gp_{ug}\log\frac{p_{ug}}{p_{u \cdot}p_{\cdot g}}.
\]</span> The <strong>Theil Index</strong> is closely related to the M index, as it is just a normalized version of the Mutual Information Index:</p>
<p><span class="math display">\[
H(\mathbf{T})=\frac{M(\mathbf{T})}{E(\mathbf{T})},
\]</span></p>
<p>where <span class="math inline">\(E(\mathbf{T})\)</span> denotes the entropy of the group marginal distribution of <span class="math inline">\(\mathbf{T}\)</span>, i.e. <span class="math inline">\(E(\mathbf{T})=-\sum_{g=1}^{G}p_{\cdot g}\log p_{\cdot g}\)</span>. Dividing through the group entropy has the effect of constraining H to be between 0 and 1.</p>
</div>
<cite><a href="https://elbersb.github.io/segregation/articles/segregation.html#the-basic-mathematics" 
target="_blank">Elbers</a></cite>
</blockquote>
</article>
<article>
<h2>Data and data format</h2>
<p>Elbers's walkthrough uses data about racial groups and schools. This walkthrough uses data about gender and 
occupation taken from the 1995 and 2000 Japan Population Censuses. This dataset can be downloaded from 
this project's <a href="https://github.com/AlanInTsukuba/tsukuba-segregation/tree/main/inst/extdata">repository</a>. 
The original data for this dataset is from <a href="https://www.e-stat.go.jp/stat-search/files?page=1&layout=datalist&toukei=00200521&tstat=000000030001&cycle=0&tclass1=000000030439&tclass2=000000030440&tclass3=000000030441&stat_infid=000000034D0D&tclass4val=0" 
target="blank">e-Stat</a>. </p>
<p>Elbers's segregation package uses data in columnar (aka, long) format. Columnar format is avaiable for 
Japanese Population Censuses conducted in 2010 and 2015, but not for earlier years. The dataset in this repository 
was reformatted from 1995 and 2000 census data; the English occupation titles were obtained from the 
<a href="https://www.stat.go.jp/english/data/kokusei/2000/syokugyo.html" target="blank">Statistics Bureau of 
Japan</a>.</p>
</article>
</main>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Elbers, Benjamin (2021). A Method for Studying Differences in Segregation Across Time and Space. Sociological Methods &amp; Research. <a href="https://doi.org/10.1177/0049124121986204" class="uri">https://doi.org/10.1177/0049124121986204</a></p>
</div>
</body>
</html>